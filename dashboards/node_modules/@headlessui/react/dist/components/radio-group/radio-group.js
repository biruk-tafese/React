"use client";import{useFocusRing as Q}from"@react-aria/focus";import{useHover as Y}from"@react-aria/interactions";import G,{createContext as Z,useCallback as me,useContext as ee,useMemo as x,useReducer as ye,useRef as B}from"react";import{useByComparator as Re}from'../../hooks/use-by-comparator.js';import{useControllable as be}from'../../hooks/use-controllable.js';import{useEvent as S}from'../../hooks/use-event.js';import{useId as K}from'../../hooks/use-id.js';import{useIsoMorphicEffect as oe}from'../../hooks/use-iso-morphic-effect.js';import{useLatestValue as te}from'../../hooks/use-latest-value.js';import{useSyncRefs as $}from'../../hooks/use-sync-refs.js';import{useDisabled as re}from'../../internal/disabled.js';import{FormFields as ge}from'../../internal/form-fields.js';import{useProvidedId as Oe}from'../../internal/id.js';import{isDisabledReactIssue7711 as ne}from'../../utils/bugs.js';import{Focus as N,FocusResult as ie,focusIn as ae,sortByDomNode as Pe}from'../../utils/focus-management.js';import{attemptSubmit as ve}from'../../utils/form.js';import{match as De}from'../../utils/match.js';import{getOwnerDocument as Ae}from'../../utils/owner.js';import{forwardRefWithAs as j,mergeProps as pe,render as V}from'../../utils/render.js';import{Description as _e,useDescribedBy as Ee,useDescriptions as le}from'../description/description.js';import{Keys as F}from'../keyboard.js';import{Label as Ge,useLabelledBy as xe,useLabels as se}from'../label/label.js';var Ce=(o=>(o[o.RegisterOption=0]="RegisterOption",o[o.UnregisterOption=1]="UnregisterOption",o))(Ce||{});let he={[0](e,t){let o=[...e.options,{id:t.id,element:t.element,propsRef:t.propsRef}];return{...e,options:Pe(o,a=>a.element.current)}},[1](e,t){let o=e.options.slice(),a=e.options.findIndex(y=>y.id===t.id);return a===-1?e:(o.splice(a,1),{...e,options:o})}},J=Z(null);J.displayName="RadioGroupDataContext";function X(e){let t=ee(J);if(t===null){let o=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,X),o}return t}let z=Z(null);z.displayName="RadioGroupActionsContext";function q(e){let t=ee(z);if(t===null){let o=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,q),o}return t}function Le(e,t){return De(t.type,he,e,t)}let ke="div";function Fe(e,t){let o=K(),a=re(),{id:y=`headlessui-radiogroup-${o}`,value:C,defaultValue:h,form:u,name:b,onChange:p,by:I,disabled:f=a||!1,...U}=e,T=Re(I),[c,R]=ye(Le,{options:[]}),l=c.options,[L,s]=se(),[g,w]=le(),D=B(null),O=$(D,t),[n,A]=be(C,p,h),_=x(()=>l.find(r=>!r.propsRef.current.disabled),[l]),P=x(()=>l.some(r=>T(r.propsRef.current.value,n)),[l,n]),i=S(r=>{var d;if(f||T(r,n))return!1;let k=(d=l.find(H=>T(H.propsRef.current.value,r)))==null?void 0:d.propsRef.current;return k!=null&&k.disabled?!1:(A==null||A(r),!0)}),m=S(r=>{let k=D.current;if(!k)return;let d=Ae(k),H=l.filter(v=>v.propsRef.current.disabled===!1).map(v=>v.element.current);switch(r.key){case F.Enter:ve(r.currentTarget);break;case F.ArrowLeft:case F.ArrowUp:if(r.preventDefault(),r.stopPropagation(),ae(H,N.Previous|N.WrapAround)===ie.Success){let E=l.find(W=>W.element.current===(d==null?void 0:d.activeElement));E&&i(E.propsRef.current.value)}break;case F.ArrowRight:case F.ArrowDown:if(r.preventDefault(),r.stopPropagation(),ae(H,N.Next|N.WrapAround)===ie.Success){let E=l.find(W=>W.element.current===(d==null?void 0:d.activeElement));E&&i(E.propsRef.current.value)}break;case F.Space:{r.preventDefault(),r.stopPropagation();let v=l.find(E=>E.element.current===(d==null?void 0:d.activeElement));v&&i(v.propsRef.current.value)}break}}),M=S(r=>(R({type:0,...r}),()=>R({type:1,id:r.id}))),de=x(()=>({value:n,firstOption:_,containsCheckedOption:P,disabled:f,compare:T,...c}),[n,_,P,f,T,c]),ue=x(()=>({registerOption:M,change:i}),[M,i]),ce={ref:O,id:y,role:"radiogroup","aria-labelledby":L,"aria-describedby":g,onKeyDown:m},fe=x(()=>({value:n}),[n]),Te=me(()=>i(h),[i]);return G.createElement(w,{name:"RadioGroup.Description"},G.createElement(s,{name:"RadioGroup.Label"},G.createElement(z.Provider,{value:ue},G.createElement(J.Provider,{value:de},b!=null&&G.createElement(ge,{data:n!=null?{[b]:n||"on"}:{},form:u,onReset:Te}),V({ourProps:ce,theirProps:U,slot:fe,defaultTag:ke,name:"RadioGroup"})))))}let Ie="div";function Ue(e,t){var P,i;let o=K(),{id:a=`headlessui-radiogroup-option-${o}`,value:y,disabled:C=!1,...h}=e,u=B(null),b=$(u,t),[p,I]=se(),[f,U]=le(),T=te({value:y,disabled:C}),c=X("RadioGroup.Option"),R=q("RadioGroup.Option");oe(()=>R.registerOption({id:a,element:u,propsRef:T}),[a,R,u,T]);let l=S(m=>{var M;if(ne(m.currentTarget))return m.preventDefault();R.change(y)&&((M=u.current)==null||M.focus())}),L=((P=c.firstOption)==null?void 0:P.id)===a,s=c.disabled||C,{isFocusVisible:g,focusProps:w}=Q({autoFocus:(i=e.autoFocus)!=null?i:!1}),{isHovered:D,hoverProps:O}=Y({isDisabled:s!=null?s:!1}),n=c.compare(c.value,y),A=pe({ref:b,id:a,role:"radio","aria-checked":n?"true":"false","aria-labelledby":p,"aria-describedby":f,"aria-disabled":s?!0:void 0,tabIndex:(()=>s?-1:n||!c.containsCheckedOption&&L?0:-1)(),onClick:s?void 0:l},w,O),_=x(()=>{var m;return{checked:n,disabled:s,active:g,hover:D,focus:g,autofocus:(m=e.autoFocus)!=null?m:!1}},[n,s,D,g,e.autoFocus]);return G.createElement(U,{name:"RadioGroup.Description"},G.createElement(I,{name:"RadioGroup.Label"},V({ourProps:A,theirProps:h,slot:_,defaultTag:Ie,name:"RadioGroup.Option"})))}let we="span";function Me(e,t){var _,P;let o=X("Radio"),a=q("Radio"),y=K(),C=Oe(),h=re(),{id:u=C||`headlessui-radio-${y}`,value:b,disabled:p=o.disabled||h||!1,...I}=e,f=B(null),U=$(f,t),T=xe(),c=Ee(),R=te({value:b,disabled:p});oe(()=>a.registerOption({id:u,element:f,propsRef:R}),[u,a,f,R]);let l=S(i=>{var m;if(ne(i.currentTarget))return i.preventDefault();a.change(b)&&((m=f.current)==null||m.focus())}),{isFocusVisible:L,focusProps:s}=Q({autoFocus:(_=e.autoFocus)!=null?_:!1}),{isHovered:g,hoverProps:w}=Y({isDisabled:p!=null?p:!1}),D=((P=o.firstOption)==null?void 0:P.id)===u,O=o.compare(o.value,b),n=pe({ref:U,id:u,role:"radio","aria-checked":O?"true":"false","aria-labelledby":T,"aria-describedby":c,"aria-disabled":p?!0:void 0,tabIndex:(()=>p?-1:O||!o.containsCheckedOption&&D?0:-1)(),onClick:p?void 0:l},s,w),A=x(()=>{var i;return{checked:O,disabled:p,hover:g,focus:L,autofocus:(i=e.autoFocus)!=null?i:!1}},[O,p,g,L,e.autoFocus]);return V({ourProps:n,theirProps:I,slot:A,defaultTag:we,name:"Radio"})}let Se=j(Fe),He=j(Ue),uo=j(Me),Ne=Ge,We=_e,co=Object.assign(Se,{Option:He,Label:Ne,Description:We});export{uo as Radio,co as RadioGroup,We as RadioGroupDescription,Ne as RadioGroupLabel,He as RadioGroupOption};
