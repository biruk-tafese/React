"use client";import{useFocusRing as Te}from"@react-aria/focus";import{useHover as de}from"@react-aria/interactions";import M,{Fragment as ce,createContext as re,useContext as ae,useMemo as D,useReducer as fe,useRef as X}from"react";import{useActivePress as be}from'../../hooks/use-active-press.js';import{useEvent as F}from'../../hooks/use-event.js';import{useId as oe}from'../../hooks/use-id.js';import{useIsoMorphicEffect as N}from'../../hooks/use-iso-morphic-effect.js';import{useLatestValue as $}from'../../hooks/use-latest-value.js';import{useResolveButtonType as me}from'../../hooks/use-resolve-button-type.js';import{useSyncRefs as G}from'../../hooks/use-sync-refs.js';import{FocusSentinel as Pe}from'../../internal/focus-sentinel.js';import{Hidden as ye}from'../../internal/hidden.js';import{Focus as m,FocusResult as B,focusIn as I,sortByDomNode as w}from'../../utils/focus-management.js';import{match as U}from'../../utils/match.js';import{microTask as xe}from'../../utils/micro-task.js';import{getOwnerDocument as ge}from'../../utils/owner.js';import{RenderFeatures as le,forwardRefWithAs as H,mergeProps as Ae,render as k}from'../../utils/render.js';import{StableCollection as Ee,useStableCollectionIndex as se}from'../../utils/stable-collection.js';import{Keys as P}from'../keyboard.js';var Le=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(Le||{}),Re=(l=>(l[l.Less=-1]="Less",l[l.Equal=0]="Equal",l[l.Greater=1]="Greater",l))(Re||{}),_e=(r=>(r[r.SetSelectedIndex=0]="SetSelectedIndex",r[r.RegisterTab=1]="RegisterTab",r[r.UnregisterTab=2]="UnregisterTab",r[r.RegisterPanel=3]="RegisterPanel",r[r.UnregisterPanel=4]="UnregisterPanel",r))(_e||{});let De={[0](e,n){var u;let t=w(e.tabs,T=>T.current),l=w(e.panels,T=>T.current),s=t.filter(T=>{var a;return!((a=T.current)!=null&&a.hasAttribute("disabled"))}),r={...e,tabs:t,panels:l};if(n.index<0||n.index>t.length-1){let T=U(Math.sign(n.index-e.selectedIndex),{[-1]:()=>1,[0]:()=>U(Math.sign(n.index),{[-1]:()=>0,[0]:()=>0,[1]:()=>1}),[1]:()=>0});if(s.length===0)return r;let a=U(T,{[0]:()=>t.indexOf(s[0]),[1]:()=>t.indexOf(s[s.length-1])});return{...r,selectedIndex:a===-1?e.selectedIndex:a}}let i=t.slice(0,n.index),f=[...t.slice(n.index),...i].find(T=>s.includes(T));if(!f)return r;let c=(u=t.indexOf(f))!=null?u:e.selectedIndex;return c===-1&&(c=e.selectedIndex),{...r,selectedIndex:c}},[1](e,n){var r;if(e.tabs.includes(n.tab))return e;let t=e.tabs[e.selectedIndex],l=w([...e.tabs,n.tab],i=>i.current),s=(r=l.indexOf(t))!=null?r:e.selectedIndex;return s===-1&&(s=e.selectedIndex),{...e,tabs:l,selectedIndex:s}},[2](e,n){return{...e,tabs:e.tabs.filter(t=>t!==n.tab)}},[3](e,n){return e.panels.includes(n.panel)?e:{...e,panels:w([...e.panels,n.panel],t=>t.current)}},[4](e,n){return{...e,panels:e.panels.filter(t=>t!==n.panel)}}},q=re(null);q.displayName="TabsDataContext";function h(e){let n=ae(q);if(n===null){let t=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,h),t}return n}let z=re(null);z.displayName="TabsActionsContext";function V(e){let n=ae(z);if(n===null){let t=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,V),t}return n}function Fe(e,n){return U(n.type,De,e,n)}let Se=ce;function Ie(e,n){let{defaultIndex:t=0,vertical:l=!1,manual:s=!1,onChange:r,selectedIndex:i=null,...R}=e;const f=l?"vertical":"horizontal",c=s?"manual":"auto";let u=i!==null,T=G(n),[a,d]=fe(Fe,{selectedIndex:i!=null?i:t,tabs:[],panels:[]}),y=D(()=>({selectedIndex:a.selectedIndex}),[a.selectedIndex]),b=$(r||(()=>{})),x=$(a.tabs),g=D(()=>({orientation:f,activation:c,...a}),[f,c,a]),S=F(p=>(d({type:1,tab:p}),()=>d({type:2,tab:p}))),L=F(p=>(d({type:3,panel:p}),()=>d({type:4,panel:p}))),_=F(p=>{v.current!==p&&b.current(p),u||d({type:0,index:p})}),v=$(u?e.selectedIndex:a.selectedIndex),O=D(()=>({registerTab:S,registerPanel:L,change:_}),[]);N(()=>{d({type:0,index:i!=null?i:t})},[i]),N(()=>{if(v.current===void 0||a.tabs.length<=0)return;let p=w(a.tabs,A=>A.current);p.some((A,j)=>a.tabs[j]!==A)&&_(p.indexOf(a.tabs[v.current]))});let W={ref:T};return M.createElement(Ee,null,M.createElement(z.Provider,{value:O},M.createElement(q.Provider,{value:g},g.tabs.length<=0&&M.createElement(Pe,{onFocus:()=>{var p,C;for(let A of x.current)if(((p=A.current)==null?void 0:p.tabIndex)===0)return(C=A.current)==null||C.focus(),!0;return!1}}),k({ourProps:W,theirProps:R,slot:y,defaultTag:Se,name:"Tabs"}))))}let he="div";function ve(e,n){let{orientation:t,selectedIndex:l}=h("Tab.List"),s=G(n),r=D(()=>({selectedIndex:l}),[l]);return k({ourProps:{ref:s,role:"tablist","aria-orientation":t},theirProps:e,slot:r,defaultTag:he,name:"Tabs.List"})}let Ce="button";function Me(e,n){var Q,Y,Z,ee,te;let t=oe(),{id:l=`headlessui-tabs-tab-${t}`,...s}=e,{orientation:r,activation:i,selectedIndex:R,tabs:f,panels:c}=h("Tab"),u=V("Tab"),T=h("Tab"),a=X(null),d=G(a,n);N(()=>u.registerTab(a),[u,a]);let y=se("tabs"),b=f.indexOf(a);b===-1&&(b=y);let x=b===R,g=F(o=>{var K;let E=o();if(E===B.Success&&i==="auto"){let J=(K=ge(a))==null?void 0:K.activeElement,ne=T.tabs.findIndex(ue=>ue.current===J);ne!==-1&&u.change(ne)}return E}),S=F(o=>{let E=f.map(J=>J.current).filter(Boolean);if(o.key===P.Space||o.key===P.Enter){o.preventDefault(),o.stopPropagation(),u.change(b);return}switch(o.key){case P.Home:case P.PageUp:return o.preventDefault(),o.stopPropagation(),g(()=>I(E,m.First));case P.End:case P.PageDown:return o.preventDefault(),o.stopPropagation(),g(()=>I(E,m.Last))}if(g(()=>U(r,{vertical(){return o.key===P.ArrowUp?I(E,m.Previous|m.WrapAround):o.key===P.ArrowDown?I(E,m.Next|m.WrapAround):B.Error},horizontal(){return o.key===P.ArrowLeft?I(E,m.Previous|m.WrapAround):o.key===P.ArrowRight?I(E,m.Next|m.WrapAround):B.Error}}))===B.Success)return o.preventDefault()}),L=X(!1),_=F(()=>{var o;L.current||(L.current=!0,(o=a.current)==null||o.focus({preventScroll:!0}),u.change(b),xe(()=>{L.current=!1}))}),v=F(o=>{o.preventDefault()}),{isFocusVisible:O,focusProps:W}=Te({autoFocus:(Q=e.autoFocus)!=null?Q:!1}),{isHovered:p,hoverProps:C}=de({isDisabled:(Y=e.disabled)!=null?Y:!1}),{pressed:A,pressProps:j}=be({disabled:(Z=e.disabled)!=null?Z:!1}),ie=D(()=>{var o;return{selected:x,hover:p,active:A,focus:O,autofocus:(o=e.autoFocus)!=null?o:!1}},[x,p,O,A,e.autoFocus]),pe=Ae({ref:d,onKeyDown:S,onMouseDown:v,onClick:_,id:l,role:"tab",type:me(e,a),"aria-controls":(te=(ee=c[b])==null?void 0:ee.current)==null?void 0:te.id,"aria-selected":x,tabIndex:x?0:-1},W,C,j);return k({ourProps:pe,theirProps:s,slot:ie,defaultTag:Ce,name:"Tabs.Tab"})}let Ge="div";function we(e,n){let{selectedIndex:t}=h("Tab.Panels"),l=G(n),s=D(()=>({selectedIndex:t}),[t]);return k({ourProps:{ref:l},theirProps:e,slot:s,defaultTag:Ge,name:"Tabs.Panels"})}let Ue="div",He=le.RenderStrategy|le.Static;function ke(e,n){var g,S,L,_;let t=oe(),{id:l=`headlessui-tabs-panel-${t}`,tabIndex:s=0,...r}=e,{selectedIndex:i,tabs:R,panels:f}=h("Tab.Panel"),c=V("Tab.Panel"),u=X(null),T=G(u,n);N(()=>c.registerPanel(u),[c,u]);let a=se("panels"),d=f.indexOf(u);d===-1&&(d=a);let y=d===i,b=D(()=>({selected:y}),[y]),x={ref:T,id:l,role:"tabpanel","aria-labelledby":(S=(g=R[d])==null?void 0:g.current)==null?void 0:S.id,tabIndex:y?s:-1};return!y&&((L=r.unmount)==null||L)&&!((_=r.static)!=null&&_)?M.createElement(ye,{as:"span","aria-hidden":"true",...x}):k({ourProps:x,theirProps:r,slot:b,defaultTag:Ue,features:He,visible:y,name:"Tabs.Panel"})}let Oe=H(Me),Ne=H(Ie),Be=H(ve),We=H(we),je=H(ke),pt=Object.assign(Oe,{Group:Ne,List:Be,Panels:We,Panel:je});export{pt as Tab,Ne as TabGroup,Be as TabList,je as TabPanel,We as TabPanels};
